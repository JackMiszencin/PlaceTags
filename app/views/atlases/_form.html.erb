<div>
	<%= nested_form_for @atlas do |f| %>
		<%= f.error_messages %>
		<div class="control-group">
			<%= f.label :name %>
			<div class="controls">
				<%= f.text_field :name, :required => true %>
			</div>
		</div>
		<%= hidden_field_tag "atlas_user_id", current_user.id, :name => "atlas[user_id]" %>
		<%= f.fields_for :types do |type| %>
			<%= type.text_field :label, :required => true %>
			<%= type.link_to_remove "Remove this type" %>
		<% end %>
		<%= render :partial => 'tag_map' %>
		<div id="right-pane">
			<%=	f.fields_for :realm do |realm| %>
				<%= realm.text_field :title, :name => 'atlas[realm_attributes][title]', :required => true %>
				<%= realm.hidden_field :atlas_id, :name => 'atlas[realm_attributes][atlas_id]', :value => @atlas.id.to_s %>
				<%= realm.hidden_field :lat, :name => 'atlas[realm_attributes][lat]' %>
				<%= realm.hidden_field :lng, :name => 'atlas[realm_attributes][lng]' %>				
				<%= realm.number_field :radius, :in => 0 ... 10000000, :step => 0.5, :value => 0, :name => "atlas[realm_attributes][radius]", :required => true %>
				<%= realm.fields_for :type do |t| %>
					<%= t.hidden_field :label, :value => "Atlas" %>
				<% end %>
			<% end %>
		</div>
		<p><%= f.link_to_add "Add another type", :types %></p>
		<%= f.submit "Create Atlas" %>
	<% end %>
</div>